
## 企业WLAN概述
WLAN -> Wireless LAN 无线技术构建的无线局域网络
无线技术不止Wifi，还有红外、蓝牙、ZigBee等 可以让用户方便的接入到无线网络
根据应用范围分为 WPAN WLAN WMAN WWAN
![[Pasted image 20241026130702.png]]
#### WLAN与WiFi
WiFi基于802.11协议的技术 在WLAN技术范围之内 WiFi只是一个组织

IEEE802.11是一种WLAN标准，WiFi是802.11标准的一个实现
#### 无线网络起源和发展
1971年的概念 1973 引入CSMA/CD 
![[Pasted image 20241026131033.png]]
WiFi联盟的意义 不同公司组成的组织 统一标准和理念技术，有一个统一的规范
![[Pasted image 20241026131208.png]]
#### 技术与应用发展助推WiFi-6时代到来
四年更新换代 n-4 ac-5 x-6
大带宽 低时延
![[Pasted image 20241026131337.png]]
WiFi6支持更多的用户接入 实际速率要远大于前一代
发展趋势：移动1.0-3.0
## WLAN面临的挑战及解决方案
### WiFi部署场景多样化
室内覆盖场景差异化、高密场馆覆盖（球场）、物联网融合、室外覆盖（校园要求）、轨道交通回传与覆盖（高铁）
### WiFi技术瓶颈影响用户体验
信号好，不代表都能接入、能接入，不代表能获得较好体验、有体验，不代表能获得一致体验
### WiFi业务的安全性被质疑
无线信道成为时代黑客的破坏重要途径、以及物联网设备
### WiFi节点增加带来规划、部署和维护复杂
![[Pasted image 20241026132340.png]]
### 新一代企业WLAN解决方案
支持802.11ax标准 WiFi6
![[Pasted image 20241026132455.png]]
### 华为WLAN方案特点
![[Pasted image 20241026132553.png]]
## 无线通信的基本概念
### 无线电波
- 无线电波是电磁波的一种
- 电磁波又称电磁辐射，是指**同相振荡，且互相垂直的电场与磁场**，在空间中以波的形式传递能量和动量，其传播方向垂直于电场和磁场的震荡方向，前进速度为光速
![[Pasted image 20241026133034.png]]
无线电波是电磁波的一种
波长 、 周期 、 频率 、 振幅（波是平缓还是陡的）
### 频率和波长
频率分为高低频
单位时间内完成周期变化的次数或数量
![[Pasted image 20241026134118.png]]
波长是波在两个相邻周期上相同点的距离，一个公式C=λ* f波长越长 频率越小 称相反的关系 毫米波 频率减小 频率用Hz表示 
![[Pasted image 20241026134330.png]]
#### 无线电波的频率与频段
![[Pasted image 20241026134351.png]]
无线电波 使用5G频段和2.4G频段 归为超高频和特高频 高频引用于民用电台
频段指的是频率范围 在范围之内 化为**频率 2.4Ghz -2.4835Ghz**
5GHz **5.15Ghz-5.35Ghz   5.725Ghz-5.85GHz)** 属于科学医疗工业等地方 ISM频段 无需许可证和费用 不对其他频段造成干扰即可
![[Pasted image 20241026134842.png]]
#### 无线电波的相位
![[Pasted image 20241026134856.png]]
一个相对术语 描述了两个同频波之间的关系 波长划分为360份 一份1°
0°作为波传播的起始时间 如果一个波在0°开始传播，另一个波在90°开始传播，就称两者90°异相 
相同频率的波在不同时间开始传播，会对电磁波的传输带来较大的影响

#### 相位对信号的影响
![[Pasted image 20241027071849.png]]
频率相同的传播 相位相同 信号就会相对增强 叠加到一起
信号减弱：相反的+180 避免相位进行的减弱
### 无线通信的过程
#### 无线通信系统
![[Pasted image 20241027072221.png]]
先编码转换为数字信号 再经过编码和调制发送出去 通过信道发送给接收设备
信道：频率范围大 不规划 效率低 车道 信道也是一样的 只能在信道1里走 
没有网线接口 是空口 接收信号 不可见 再解调解码

#### 编码
![[Pasted image 20241027072426.png]]
信源编码：原始信号转化成数字信号 并压缩 然后编码
信道编码：对信息纠错检测的技术 提升信道传输的成功率 能够在接收设备上最大程度的接收信息 降低误码率 保障信道传输
#### 调制与解调
![[./ScreenShot/Pasted image 20241027073240.png]]
调制：数字信号转换成波 传输信息的话 需要调制解调 
先调幅A 2A
调频：正常频率 放缓频率或增加频率
调相：不同节点相位不一样 调相的话做一个180度调整 三种调制方式传递给对端 把频带解析成数字信号 再解码形成原始数据

### 载波
![[./ScreenShot/Pasted image 20241027085633.png]]
频率固定的电磁波 称为载波 可以将数据的信号加载到载波的信号上 接收方按照载波的频率来接收数据信号，有意义的信号波的波幅与无意义的信号波幅是不一样的 将这些信号提取出来就是对应的数据信号 电磁波就是载波 对载波做了更细的划分
#### 子载波
![[./ScreenShot/Pasted image 20241027090054.png]]
子载波是对应不同的子信道进行传输的 大多数WIFi技术都是用OFDM(多载波调试技术)来传输的 将多子载波进行并行的传输

### 信道的概念
![[./ScreenShot/Pasted image 20241027090219.png]]频段如何划分信道
频宽：信道的宽度 802.11n \ ac \ x 频宽都是20Mhz  把信道的中间频率称为信道的频率 信道1的频率是2.412 
重叠和非重叠信道 2.417 2.412 相差5  重叠区域称为相邻的频率，也就是邻频，如果同时传输 会干扰 叫做邻频干扰 我们一般考虑相同空间内的传输数据，使用不同频率的信道 非重叠信道传输

做网规要考虑3D层面的非重叠信道的部署
![[./ScreenShot/Pasted image 20241027172143.png]]
![[./ScreenShot/Pasted image 20241027172214.png]]
14信道单独定义2.484GHz，仅少数国家使用
5G划分两段 国际上三段 UNII免许可证 分了不同的段 有些段可以用，有些不能用 中国10-144信道不可用
前两部分信道仅供室内使用 后一部分室内室外都可以使用 5G频段信道数量更多 频段不同 这里的5G和通信领域的5G不一样 这里的指的是5GHz的频率的Wifi 在频率速度抗干扰都比2.4要好 但是由于频率高 波长比2要断 穿透性强 距离蒻

各国对频段范围略有不同 频段宽 干扰小 适合高速传输
#### 信道绑定
![[./ScreenShot/Pasted image 20241027172624.png]]
两个信道绑定到一起当做一个用提高效率
802.11ac 绑定信道 一个信道20M 八个绑定 传输速率超过千兆

### 射频、频段、天线
![[./ScreenShot/Pasted image 20241027172738.png]]
射频：通过天线收发固定范围的无线电波 一个AP可能有多个射频  可能有两个 双射频 一个射频里面可能会有三根天线 天线是一个物理硬件 频段是射频的频率范围
#### 什么是空间流
![[./ScreenShot/Pasted image 20241027172921.png]]
空间流：不同的设备上都有不同的天线数量 例如有两个天线 一个发送天线对应一个接收天线 就建立了两个连接 因为是用空口连接的 信息在空间里传输 叫做空间流 两个天线最多建立两个空间流 WiFi6的目前最好的AP可以实现12个空间流

### 什么是单射频、双射频以及三射频AP
![[./ScreenShot/Pasted image 20241027173144.png]]
射频数量不同分为三种AP
保证客户端性能的前提下 接入更多的终端 有带宽的需求下单个无线射频模块 可以介入20-25个客户端 如果同时 40-50个客户端

###  干扰
![./ScreenShot/[Pasted image 20241027173503.png]]
非法：在公司开自己的热点Wifi 就是非法AP释放的信号 非法：其他网络提供的无线服务 对于正在使用的服务来讲 是有干扰的
#### 干扰与信道利用率
![[./ScreenShot/Pasted image 20241027173704.png]]
利用率：在WLAN里面是时间的概念 等待时间很短 处于微秒级 但是拉长就影响信道利用率
#### 理论速率和实现速率
![[./ScreenShot/Pasted image 20241027173842.png]]
## 802.11标准介绍
![[Pasted image 20241027202007.png]]
- IEEE 802.11无线局域网工作组制定的规范分两部分
	- 802.11物理层相关标准
	- 802.11MAC层相关标准
- 802.11物理层标准定义了无线协议的工作频段、调制编码方式及最高速的支持
	- 802.11 802标准化委员会成立无线局域网标准工作组 定义了物理层和媒体访问控制层(MAC)规范 物理层定义了数据传输的信号特征和调制 工作在**2.4-2.4835Ghz 传输速率最高2Mbps**
	- a 99年 该标准规定无线局域网工作频段在**5.15~5.825GHz，数据传输速率达到54Mbps**
	- b 99年9月 规定无线局域网工作频段在2.4-2.4835Ghz 速率11Mbps
	- g 对流行的b的**提速**，从11Mbps提高到54Mbps 支持**b**以及**g**的客户设备
	- n 使用2和5G 核心是MIMO(Multiple input Multiple Output)和[[#OFDM]]技术 传输速度**300Mbps 最高可达600Mbps** 向下兼容b和g
	- ac WLAN通信标准 提供5GHz频带进行通信。**理论上最新版本能够提供3.47Gbps带宽进行多站式无线局域网通信**，或最少**200Mbps的单一连接传输带宽**
	- ax WiFi-6 于19年9月16开启WiFi-CERTIFIED 6认证计划 于20年1.3 **将使用6GHz频段的IEEE802.11ax称为WiFi6E**。ax**支持从1GHz到6GHz的所有ISM频段**，包括目前已使用的2.4GHz和5GHz 向下兼容 **a b g n ac** 支持室内室外场景、提高频谱效率 相比ac 密集用户环境下实际吞吐量提升4倍，标称传输速率提升37% 延迟下降75%
- MAC层标准定义了无线网络在MAC层的一些常用操作：如QOS、安全、漫游等操作
	- e 标准对无线局域网MAC层协议提出改进，以支持**多媒体传输**，以支持所有无线局域网无线广播接口的服务质量保证QOS机制。
	- h 设计两种技术，一种是动态频率选择，**用于检测在一个信道上有其他信号出现，当该信号被检测到时，就会自动将网络转移到另一个信道**。另一种技术是传输功率控制，主要是**减少网络传输的无线频率输出功率，使系统间干扰最小，而且还可以达到更好的网络性能**
	- i 标准结合X中的用户端口身份验证和设备验证，对**无线局域网MAC层进行修改和整合**，定义了严格的加密格式和鉴权机制，**改善无线局域网的安全性**
	- r 快速基础服务转移，解决切换不同无线AP时的延迟 h 用于 a的频谱管理技术
### IEEE 802.11标准与WiFi的时代
![[Pasted image 20241027205126.png]]
### 802.11 a/b/g
- a 5GHz
	- 采用正交频分复用(OFDM)
	- 支持6,9,12,18,24,36,48&54Mbps数据速率
	- 工作在无需许可的5GHz频段，可使用23个非重叠信道
- b 2.4GHz
	- 采用直序扩频(DSSS)
	- 支持1,2,5.5 & 11Mbps数据速率
	- 频宽为22MHz
- g 2.4GHz
	- 采用正交频分复用
	- 支持a和b的数据速率
	- 兼容b终端
### 802.11n
![[Pasted image 20241028104239.png]]
n协议为双频工作模式 保障与以往标准兼容
为改善实时业务服务质量，定义了**单用户波束成形技术**来改善接受状况，还纳入了*e(QoS)* 标准修订，要求支持e。在天线和传输技术的发展下，使得无线局域网传输距离增加，**可达几公里，并能保障100Mbps的传输速率**
结合物理层和MAC层优化来充分提高WLAN技术的吞吐。物理涉及到**MIMO MIMO-OFDM 40MHz Short GI**等技术 物理层吞吐量提高到**600Mbps** 仅提高物理层速率，未对空口访问等MAC层协议优化，该优化将无从发挥 对*MAC*采用了**block确认、帧聚合技术，提高MAC层效率

FEC(Forward Error Correction)为了使信息适合在无线信道这种不可靠的媒介中传递，发射端将把信息进行编码并携带冗余信息，以提高纠错能力，使接收端能够恢复原始信息，n采用的**QAM-64**编码机制可以将编码率(有效信息/整个编码)从3/4提高到5/6 所以对于一条空间流，在MIMO-OFDM上，物理速率从58.5提高到了**65** 58.5 * 5/6 /3 * 4
- n仍然使用缺省使用800ns GI。当多径效应不是很严重时，用户可以将该间隔配置为400，对于一条空间流，可以将吞吐提高10%，即从65提高到72.2 对于多径效应较明显的环境，不建议使用 Short GI
帧聚合技术包含针对MSDU的聚合(A-MSDU)和针对MPDU的聚合(A-MPDU)
- MSDU可以认为是Ethernet报文，A技术是指把多个该报文通过一定方式聚合成一个比较大的载荷。当接收到MSDU时，会打上Ethernet报文头，称之为A-MSDU Subframe；而在通过射频口发送出去之前，需要将其转化成802.11报文格式。该技术旨在**将若干个A-MSDU Subframe**聚合到一起，封装为一个802.11报文进行发送，从而减少发送每一个802.11报文所需的**PLCP Preamble 、 PLCP Header**与802.11MAC头的开销，同时减少了应答帧的数量，提高报文发送的效率
- A-MPDU聚合的是经过802.11报文封装后的MPDU 通过一次性发送若干个MPDU，减少了发送每个802.11报文所需的PLCP Preamble PLCP Header，从而提高了吞吐量
块确认技术
- 为了保障可靠性，.11协议 规定每收到一个单薄真，都必须回应ACK帧。AMPDU接收端接收到后，需要对每一个MPDU处理，同样针对**每一个MPDU** 发送应答帧。**Block Acknowledgement**通过使用**一个ACK帧完成对多个MPDU的应答**，以降低这种情况下ACK帧数量
### 802.11n 关键技术
![[Pasted image 20241028111059.png]]
> • 802.11n速率达到600 Mbps的原因是： 
> 	▫ 最大支持4个空间流； 
> 	▫ 支持信道绑定技术，5 GHz场景下最大可实现每信道108个子载波； 
> 	▫ 可以启用short GI技术，使得原本0.8 us的GI，缩短为0.4 us； 
> 	▫ 编码率从3/4提升到了5/6； 
> 	▫ 802.11n使用20 MHz信道带宽时数据速率可达到300 Mbit/s，而40 MHz信道带 宽时数据速率可达到600 Mbit/s

### 802.11ac
![[Pasted image 20241028111323.png]]
这一次进行了众多的革新，如果将这些标准一次性变成产品推向市场需要花费大量时间，因此被拆分成了两个阶段 这既可以将该技术快速推向市场，又带来了技术的可演进性，保持了竞争力
ac定义了下行MU-MIMO技术，支持下行多用户并行传输
A-MPDU拓展
- 从n开始，在MAC引入了帧聚合技术，将MSDU或MPDU进行聚合后再进行物理层封装，使得多个帧共用一个物理头，提高封装效率，减少对空口的占用和争抢次数
- 当传输过程中发生错误时，**A-MSDU需要对整个聚合的帧重传**，而在A-MPDU中**每个MPDU都有自己的MAC头，发生错误时只需要对错误的数据包重传，而不需要对整个聚合帧重传**
- ac数据帧必须使用A-MPDU模式来发送，即A-MPDU不能关闭
ac中，增强定义了RTS/CTS机制，用来协调什么时候信道可用和哪些信道可用，具体机制：
- 设备在其使用的信道内，以20MHz为单位的子信道发送RTS。当带宽为80M时，再复制三份充满80MHz铃铛信道带宽为160M时，复制7份，充满160M。这样做的好处是，不管周边设备的主信道是80/160中的任意20M都可以侦听到RTS报文，每个收到RTS报文的设备将虚拟载波侦听设为忙碌
- 收到RTS报文的设备会检测其主信道或者80M带宽内的其他子信道是否繁忙。如果信道带宽的一部分被使用，啧接收设备只会在CTS帧内响应可用的20MHz子带宽，并报告重复的带宽
- 在每个20MHz的子信道上回CTS报文，这样发送设备就知道哪些信道可用，哪些不可用，最终只在可用的信道上发送数据
- RTS和CTS支持动态频宽模式，在此模式下假如部分频宽已被占用则只在主通道上发送CTS帧，发送RTS帧的客户STA则可以回落到一个较低频宽模式。
### 802.11ax
![[Pasted image 20241028115930.png]]
在ac时，引入了 DL MU-MIMO 但遇到了以下问题
	1.许多客户端设备是单天线，且许多双天线客户端切换到用于DL MU-MIMO的单流模式以防止干扰；使用4天线，与单个用户相比的增益是适度的
	2.即使构建了8天线AP，分组也限制为4个用户：
		来自用户的信道探测响应在时间上连续发送，导致高开销
		在没有ULMU增强的情况下，在上行链路上具有TCP ACK的TCP/IP受到削弱
ax 的MUMIMO的增强功能如下
	支持UL MU-MIMO
		探测帧、数据帧可以在多个用户之间分组，以减少开销并增加上行链路响应时间
		对于DL和UL，扩展到八个用户，现在，即使设备处于单流模式，MU-MIMO吞吐量也可以在单用户操作中增加一倍或者三倍
	ac引入了4x4下行链路MU-MIMO AP同时向多达四个STA发送独立数据流 ax将下行链路支持拓展到8个 还增加了对8x8上行链路MU-MIMO的支持，允许多达八个STA通过相同的频率资源同时传输到单个AP。结果是，与802.11ac相比，下行容量x2 上行容量x8
### WiFi 6 理论速率计算
![[Pasted image 20241028165255.png]]
- 空间流
	- 空间流，华为6产品，24GHz有四根物理天线，可以实现四个空间流，5GHz由于协议限制，最大只能实现8个空间流，所以可以实现8个空间流
- 编码方式或每子载波编码bit数
	- 编码方式就是调制技术，是一种将信号源产生的信号转换为适宜无线传输形式的过程，即一个Symbol里面能承载的bit数量
	- 三种最基本的调制方法：调幅、调频和调相，ASK FSK PSK 其他各种调制方法都是以上方法的改进或组合，如正交振幅调制QAM就是调幅和调相的组合，WiFi采用的是正交振幅调制QAM
	- 比如ax的调制方式是1024QAM，那么代表的子载波携带的数据大小是log 2 1024 =10bit，ac是256QAM 8bit 简单说就是 ax采用的是1024QAM正交幅度调制，每个符号传输10bit数据，wifi5 一个符号传输8bit数据
- 编码率
	- 简写为R 为了使信息适合在无线信道这样不可靠的媒介当中传递，发射段将把信息进行编码并携带冗余信息，以提高系统的纠错能力，使及手段能够恢复原始信息。编码率的大小可以理解为：编码位元到数据位元的转化率。R=1/2 的编码率代表每两个编码位元传递一个数据位元，其中一个位元是冗余位元。3/4同理。编码率的提升，意味着纠错能力的降低，此时接收端需要更清晰的信号。在平时也会发现接收端信号差的时候就会降速。原因就是其降低了编码率以及调制方式
- Symbol
	- 协议最终把在每个子信道调制出的数据一起传递出去，而一次传递出的数据就叫做一个Symbol，也称一个符号。Symbol是指终端发送数据的时候，能够发送数据占用的时长，该时长是固定值，ac中，长度是3.2us ax 12.8us 在6协议中，客户端每次呢够占用更多时间传输报文
- GL
	- 指每次发送数据后的间隔，没轮到一个终端发送数据，发送Symbol时间之后，需要停留一个Gl时间，ac中0.8us 可以使用Short GI技术 达到0.4us 但是在x中 是一个固定值
	- ax只能用固定值的原因是速率远大于ac 就跟公路上的两辆车之间要有一定的距离，否则容易追尾，同时快车道上的车距一定比慢车道上的车距要大，当突发事件发生的时候，车距越大有效制动的范围也就越大 避免交通事故的发生 在无线传输上，也是同样的道理 当传输较快时，Gl也需要适当增加，避免Symbol信号之间的干扰
- 有效子载波数量
	- 总的子载波数量=带宽xSymbol长度，比如20MHz ac信道的带宽是20MHz，长度是3.2us，那么子载波数量也就是 20x103x3.2x10-6=64 由64个子载波组成，其中52个子载波用于承载调制数据，4个子载波用于导频载波，8个子载波用于保护频带
	- 对于a/b/g为了防止相邻信道干扰，20MHz带宽的信道在其两侧预留了一小部分的带宽边界。在n采用40MHz频宽时，这些预留的带宽也可以用来通讯，从而进一步提高了吞吐，这样的话，子载波carriers可以达到52x2+4=108个，大于52x2个
	- 对于ac 频宽由40MHz升级80MHz乃至160MHz，其子载波由n的108个变成了234个和468个
	- 对于ax 子载波频宽为78.125KHz，在20MHz频宽时，子载波数量已经可以达到234个，40MHz，可以实现468个有效子载波，80MHz，可以实现980个有效子载波，160MHz时，可以实现最大1960个子载波。在2.4GHz频段，最大有效子载波为468个，在5G频段，为1960个
## WLAN的关键技术
### IEEE 802 与TCP/IP对等模型
![[Pasted image 20241028200801.png]]
### WLAN关键技术概览
![[Pasted image 20241028200859.png]]
### 802.11物理层技术
![[Pasted image 20241028200917.png]]
- 跳频(Frequency hopping)
	- 跳频系统是以某种随机样式在频率间不断跳换，每个子信道只进行瞬间的传输
- 直接序列(Direct Sequence)
	- 直接序列系统利用数学编码函数将功率分散于较宽的频带
- 正交频分复用(OFDM Orthogonal Frequency Division Multiplexing)
	- 将可用信道划分成一些子信道，然后对每个子信道所要传送的部分信号进行平行编码

### OFDM
![[Pasted image 20241028202433.png]]
- 802.11a是基于正交频分复用的
- 会将一个较宽的信道分割成几个子信道。每个子信道均用来传输数据
- 能够区别副载波，关键在于它使用了一种复杂的数学关系，称为正交性。在数学上，正交用来描述相互独立的项目
- OFDM之所以能够运作，是因为所选用的副载波频率的波形丝毫不受其他副载波的影响
#### OFDM 5GHz 信道示例
![[Pasted image 20241028203412.png]]

#### OFDM子信道调制技术
![[Pasted image 20241028205821.png]]
为提高吞吐率，ac中引入调制效率更高的256Q-AM 支持3/4 5/6两种码率 MCS方式也因此增加到了10种 ac放弃了原来为每个MIMO组合进行MCS编码 因此 编码方式也由原来的几十种变成了10种。MCS越高 吞吐率越高 由于调制编码方式的区别带来的每个子载波代表的bit数的差异 在使用BPSK调制时每个子载波只能表示两个bit，16-QAM 4bit 64 6bit 256 每个子载波可以表示8bit 越高阶的调试方式调制效率越高，但不同调制方式时的效率提升也并不是线性的，越往后提升越不明显
为提高吞吐率 ax中引入调制效率更高的1024 QAM 支持 3/4 5/6 码率 MCS方式也因此增加到12种。
#### OFDMA频分复用技术
![[Pasted image 20241029094326.png]]
![[Pasted image 20241029095342.png]]
![[Pasted image 20241029113252.png]]

- OFDM模式
	- 用不同时间区分 在一个时间段内一个用户完整占据全部的子载波并发送一个完整的数据包
- OFDMA模式
	- AP根据多个用户的通信需求决定如何分配信道 始终在下行方向分配所有可用的资源单元，可能一次将整个信道分配给一个用户或分区以便同时服务多个用户。用户是根据时频资源块RU区分出来的。首先先将整个信道的资源分成一个固定大小的RU，在该模式下，用户数据是承载在每一个RU上的，从总的时频资源上来看，每一个时间片上，可能有多个用户同时发送
	- 在该模式下，可以更加细腻的分配信道资源，同时提供更好的QoS
- RU(Resource Unit)
	- 在ax中RU是一个相对的概念 存在多种不同大小的 ax给出了不同大小RU所包含的子载波数量，包括 26/52/106/242/484/996/2* 996/等多种规格。484-tone仅出现于40、80、160MHz中 996 出现于80、160 2* 996 160MHz
- WiFi6 标准里采纳了该技术用来提高频谱的利用效率 以80MHz频宽为例，最多可以分成37个RU，同时供37个用户并发
- 6对子载波的间隔进行了重新设计，从5的312.5变成78.125kHz，通过把子载波间隔缩小四倍，在相同信道频宽条件下，6的子载波数量也提升到5的4倍
- OFDMA相比OFDM一般有两点好处
	- 资源的更细腻分配，在部分节点信道状态不太好的情况下，可以根据注水定理的思想(根据信道质量分配发送功率)，来更细腻化的分配信道时频资源
	- 能够更好的提供QoS。最初的802.11是占据整个信道的，之前一个数据包想要发送要等前一个人发完，但是现在一个发送者只占部分信道，那么能减少QoS节点接入的延迟
	- 更多的用户并发和更高的用户带宽
- 28-tone RU与雷达信号相似 容易引起雷达误检测
- ax中最小RU尺寸是2MHz，最小子载波带宽是78.125kHz，因此最小RU类型为26子载波RU，依此类推，还有52 106 242 484 和 996
- 对于一个RU来说，包含有数据子载波以及导频子载波，数据子载波最主要用于承载数据，导频子载波主要是用于信道估计。各子载波数量与RU大小关系如下表所示
![[Pasted image 20241029113626.png]]
### 802.11 MAC层
![[Pasted image 20241029113653.png]]CSMA/CA是站点在发送数据前，先监听是否忙，不忙发送，忙了等一段时间发送
#### 什么是CSMA/CA
![[Pasted image 20241029113842.png]]
- CSMA/CA的基础是载波侦听，11协议根据WLAN网络的媒体特点提出了两种载波侦听方法，这两种侦听方式可以同时进行，切两种侦听方式只要其中任意指示媒体正在被使用，就是处于忙的状态
	- 物理载波侦听：由物理层提供，取决于所使用的介质和调制方式。从接受射频或天线信号检测信号能量，根据信号质量来估计信道的忙闲状态
	- 虚拟载波侦听：由MAC层所提供，发送站点将它还要占用信道的时间“通知”给其他站点，以便其他站点在这段时间都停止发送数据
- 虚拟并非是未检测，而是其他站收到了发送站的通知不发送，达到了监听的效果。这里的通知是指发送站点在其MAC帧首部中的Duration(持续时间)字段中填入了在本帧结束后还要占用信道多少时间(以us为单位),包括接受站点发送ACK帧所需的时间。当除发送源和接受站点之外的其他站点检测到正在信道中传送的MAC帧首部的Duration字段时，就调整自己的网络分配向量NAV(Network Allocation Vector)
- 无线局域网不能使用碰撞检测，只要开始发送数据，就一定把整个帧发送完毕。由此可见，如果在无线局域网的发送过程中，一旦发生了碰撞，那么整个信道资源在这段时间久白白浪费了，因此，无线局域网应当尽量减少碰撞的发生
- 局域网在使用CSMA/CA的同时，还使用停止等待协议，由于质量原因，因此无线站点每通过无线局域网发送完一帧后，要等到收到对方的确认帧后才能技术发送下一帧。这叫做链路层确认

#### RTS/CTS
![[Pasted image 20241030084928.png]]
总而言之，就是先使用rts建立连接，建立成功之后发送cts，以至于让除去sta1之外的所有设备不与AP进行通信。

#### 帧间间隔
![[Pasted image 20241030170336.png]]
- SIFS Short IFS 短帧间间隔
	- 最短的等待时间，最高优先级
	- 用来分隔开属于一次对话的各帧。一个站应当能够在这段时间内从发送方式切换到接收方式
	- 使用SIFS帧间间隔的场景：应答ACK帧、应答CTS帧、过长的MAC帧分片后的数据帧、应答AP探寻帧、STAF方式中接入点AP发送出的任何帧
- DIFS Disribute coordination function IFS 分布协调功能帧间间隔：
	- 等待时间最长，优先级最低
	- 在DCF方式中用来发送数据帧和管理帧
	- DIFS是竞争式服务中最短的媒体闲置时间。如果媒体闲置时间长于DIFS，则STA可以立即对媒体进行访问
#### CSMA/CA协议的关键技术
![[Pasted image 20241030175412.png]]
> • STA信道空闲需要再等待一个DIFS时间，是因为考虑到可能有其他的站有一高优先级 的帧要发送。如有，就要让高优先级帧先发送。 
> • 如果没有高优先级的帧，则准确开始发送数据。 
> • 在发送数据之前，使用RTS和CTS报文来避免报文冲突，也就是虚拟载波监听(Virtual Carrier Sense)的机制，这就是让STA把它要占用信道的时间(包括AP发回确认帧所需 的时间)及时通知给所有其STA，以便使其他所有STA在这一段时间都停止发送数据， 这样就大大减少了碰撞的机会。 
> 	▫ “虚拟载波监听”是表示其他站并没有监听信道，而是由于其他站收到了“源 站的通知”才不发送数据。这种效果好像是其他站都监听了信道。所谓“源站 的通知”就是源站在其MAC帧首部中的第二个字段“持续时间”中，填入了在 本帧结束后还将要占用信道多少时间(以微秒为单位)，包括目的站发送确认帧 所需的时间。 
> • 当一个STA检测到正在信道中传送的MAC帧首部的“持续时间”字段时，就调整自己 的网络分配向量NAV（Network Allocation Vector)。 NAV指出了必须经过多少时间 才能完成数据帧的这次传输，才能使信道转入到空闲状态。因此，某个站认为信道处 于忙态就有两种可能，一种可能是由于其物理层的载波监听检测到信道忙，另一种可 能就是由于MAC层的虚拟载波监听机制指出了信道忙。 53 Huawei Confidential CSMA/CA协议的关键技术
> • 当信道从忙态变为空闲时，任何一个站要发送数据帧时，只要不是要发送的第一个帧， 不仅都必须等待一个DIFS的间隔，而且还要进入争用窗口，并计算随机退避时间，以 便再次重新试图接入到信道。在以太网的CSMA/CA协议中，在监听到信道变为空闲 时，就执行退避算法。 
• 现在假定没有高优先级帧要发送，因而源站发送了自己的数据帧。目的站若正确收到 此帧，则经过时间间隔SIFS后，向源站发送确认帧ACK。若源站在规定时间内没有收 到确认帧ACK(由重传计时器控制这段时间)，就必须重传此帧，直到收到确认为止， 或者经过若千次的重传失败后放弃发送。 
• 当一个STA检测到正在信道中传送的MAC帧首部的“持续时间”字段时，就调整自己 的网络分配向量NAV（Network Allocation Vector)。 NAV指出了必须经过多少时间 才能完成数据帧的这次传输，才能使信道转入到空闲状态。因此，某个STA认为信道 处于忙态就有两种可能，一种可能是由于其物理层的载波监听检测到信道忙，另一种 可能就是由于MAC层的虚拟载波监听机制指出了信道忙。 
• CSMA/CA算法总结如下： 
	▫ (1)若STA最初有数据要发送(而不是发送不成功再进行重传)，且检测到信道空 闲，在等待时间DIFS后，就发送整个数据帧。 
	▫ (2)否则，站点执行CSMA/CA协议的退避算法。一旦检测到信道忙，就冻结退 避计时器。只要信道空闲，退避计时器就进行倒计时。 
	▫ (3)当退避计时器时间减少到零时(这时信道只可能是空闲的)，站点就发送整个 的帧并等待确认。 
	▫ (4)发送站若收到确认，就知道已发送的帧被目的站正确收到了。这时如果要发 送第二帧，就要从上面的步骤(2)开始，执行CSMA/CA协议的退避算法，随机 选定一段退避时间。 
• 若源站在规定时间内没有收到确认帧ACK(由重传计时器控制这段时间)，就必须重传 此帧(再次使用CSMA/CA协议争用接入信道)，直到收到确认为止，或者经过若干次的 重传失败后放弃发送。

#### 802.11的随机退避机制
![[Pasted image 20241030180959.png]]
- 802.11标准也是使用二进制指数退避算法，第i次退避就在22+i个时隙中随机的选择一个。就是说，第一次退避是在8个时隙中随机选择一个，第二次退避是在16个时隙当中随机荀泽一个，当编号达到255时，就不再增加了，对应第六次退避
- 当某个要发送数据的STA，使用退避算法选择了争用窗口中的某个时隙后，就根据该时隙的位置设置一个退避计时器(backoff timer)，当退避计时器的时间减小到0时，就开始发送数据。也可能当退避倒计时的时间还未减小到0时信道又忙，冻结退避计时器的数值，等信道空闲，在经过时间DIFS后，继续启动退避计时器(从剩下的时间开始)。这种规定有利于继续启动退避计时器的站更早地接入到信道中
- 上图中可以看出，STA3的退避计时器先到0，于是STA3立即把整个数据帧发送出去，3发送完之后信道变为空闲。3的退避计时器一直在倒计时。当3在发送数据的过程中，其他STA检测到信道忙，就冻结各自的退避计时器的数值，重新期待信道变为空闲
- 当3发送完数据兵经过了时间DIFS之后，其他STA的退避计时器又从各自的剩余时间开始倒计时。现在4的先清零，于是4得到了发送权。在4发送数据时，其他都冻结退避计时器，一直到把最后剩余的时间用完，然后发送数据。冻结退避计时器的剩余时间的做法是为了使协议对所有站点更公平
#### RTS/CTS-隐藏节点
![[Pasted image 20241030181934.png]]
> • 为了解决无线网络中的隐藏终端问题，IEEE802.11协议允许站点使用一个请求发送帧 （Request to Send, RTS)控制帧和一个允许发送帧（Clear to Send, CTS)控制帧来预 约对信道的访问。 
> • RTS/CTS机制的工作原理是，发送站点在向接收站点发送数据包之前，即在DIFS之后 不是立即发送数据，而是代之以发送一个请求发送RTS（Ready To Send）帧，以申 请对介质的占用，当接收站点收到RTS信号后，立即在一个短帧隙SIFS之后回应一个 准许发送CTS帧，告知对方已准备好接收数据。双方在成功交换RTS/CTS信号对（即 完成握手）后才开始真正的数据传递，保证了多个互不可见的发送站点同时向同一接 收站点发送信号时，实际只能是收到接收站点回应CTS帧的那个站点能够进行发送， 避免了冲突发生。即使有冲突发生，也只是在发送RTS帧时，这种情况下，由于收不 到接收站点的CTS消息，大家再回头用DCF提供的竞争机制，分配一个随机退守定时 值，等待下一次介质空闲DIFS后竞争发送RTS帧，直到成功为止。 
> • RTS帧和CTS帧的使用可以在两个重要方面提升性能： ▫ 隐藏终端问题被减轻了，因为长数据帧只有在信道预约后才能被发送； ▫ 因为RTS帧和CTS帧较短，涉及RTS帧和CTS帧的碰撞将仅持续很短的RTS帧或 CTS帧持续期。一旦RTS帧和CTS帧被正确传输，后续的数据帧和Ack帧应当能 无碰撞的发送。

#### RTS/CTS-暴露节点
![[Pasted image 20241030182355.png]]
#### 2.4GHz信道绑定
![[Pasted image 20241030182424.png]]
- 40MHz虽然可以获得更多的频谱利用率，获得20的两倍吞吐量，但对于2.4频段有限的频谱资源来说有些尴尬，因为在该频谱中无法实现两个互不干扰的40信道的划分，只能使用15913来勉强实现2个不重叠心动
- 为避免相互干扰，原本每20MHz信道之间都会预留一小部分带宽，当采用信道绑定技术工作在40M带宽时，这一部分预留的带宽也可以被用来通信，进一步提高了吞吐量
- 若捆绑两个相邻的20MHz信道时，辅助20MHz带宽的中心频率低于主信道的中心频率，则为plus，反之则为minus。
	- 2.4G中，主信道选1就是plus，捆绑后也称1plus，表示以1为主信道，5为辅信道，频宽为40MHz的捆绑信道
	- 主信道如果选5的话就是minus方式，5minus，表示以5为主信道，1为辅信道，频宽为40MHz的捆绑信道
#### 5GHz信道绑定
![[Pasted image 20241030183133.png]]
>• 5GHz频段具有丰富的频谱资源，FCC分配了23个互不重叠20MHz信道，在中国也有5 个互不重叠20 MHz信道，有足够的信道来实现40 MHz信道的捆绑。 
>• 因此，40 MHz 频宽的11n模式基本不建议在2.4GHz使用，即802.11g/n模式一般都 采用20 MHz频宽进行部署，获取更多的信道资源，以满足蜂窝覆盖的原则。 
>• 40 MHz信道是将两个相邻的20 MHz信道捆绑在一起形成的。其中一个是主信道，另 一个是辅信道。 
>• 80 MHz信道是将两个相邻的40 MHz信道捆绑在一起形成的。在80 MHz频宽的信道 中，必须选一个20 MHz的信道作为主信道，那么这个主信道所在的40 MHz信道中， 剩余的20 MHz信道称为辅20 MHz信道，而不包含这个主信道的40 MHz称为辅40 MHz信道。 
>• 160 MHz信道是将两个相邻的80 MHz信道捆绑在一起形成的。在160 MHz频宽的信 道中，必须选一个20 MHz的信道作为主信道，那么这个主信道所在的80 MHz信道中， 剩余的20 MHz信道称为辅20MHz信道，不包含这个主信道的40 MHz信道称为辅40 MHz信道。不包含这个主信道的80 MHz称为辅80 MHz信道。在所有可用的5 GHz频 段中，至多可以划分出2个160 MHz信道。 
>• 80+80 MHz信道是将两个不相邻的80 MHz信道捆绑在一起形成的，主信道和辅信道 的划分与160 MHz信道类似。相较于160 MHz信道方案，80+80 MHz信道方案可以 在5GHz频段内划分出3个以上非重叠信道，可以用于蜂窝式信道规划，更加贴近实际 无线网络部署的需要。

#### SISO、MISO、SIMO及MIMO
![[Pasted image 20241030183339.png]]
SISO
	发射天线和接收天线之间路径唯一，这样传输系统不可靠，且传输速率也会收到限制。为改变这一点，试着将终端改造，在终端处加一个天线，使得接收端可以同时接收到2路信号，也就是单发多收
SIMO
	发射天线和接收天线之间有两条路径，但发送数据还是从同一个发送天线发出的，传输的还是一份信号，可靠性提升了一倍，这种方式也叫做接收分集
MISO
	发射天线和接收天线之间有两条路径，但接收天线只有一个，这就导致发射天线只能发送相同的数据，传输的还是只有一份信号，和SIMO效果相似，这种传输系统叫做多输入单输出。这种方式也叫发射分集
MIMO
	该技术允许多个天线同时发送和接收多个空间流，即多份信号，并能够区分发往来自不同空间方位的信号，通过空间服用和空间分集等技术，在不增加带宽的情况下，提高系统容量、覆盖范围和信噪比
#### MU-MIMO
![[Pasted image 20241030184055.png]]
• 支持MU-MIMO技术的路由器可以同时与多个终端设备进行数据传输，串行变并行， 缩短连网终端设备从无线路由器获取数据的等待时间。另外，每台设备得到的频宽资 源并没有打折扣，因此资源可以得到最大化的利用，从而提高路由器的带机量和终端 上网速度。
#### MIMO-波束成形
![[Pasted image 20241030184141.png]]
#### BSS Color
![[Pasted image 20241030184831.png]]
• 以这种方式设计的网络，那些具有相同颜色的信道彼此相距很远，此时我们再利用动 态CCA机制将这种信号设置为不敏感，事实上它们之间也不太可能会相互干扰。
#### TWT
![[Pasted image 20241030184859.png]]
- 每一代新标准都可以延长客户端的续航时间，因为数据传输的距离更长、速度更快，因此客户端可以实现更低的功耗。然而区别于过去的标准，6还支持一项成为唤醒时间调度TWT的新特性，允许AP告诉客户端何时休眠，并给客户端提供何时唤醒的调度表。不然多次休眠影响客户端续航
- Target Wakeup Time 按需唤醒终端WiFi 终端功耗可降低30%
- 是由ah标准首次提出，初中针对IoT设备，尤其是低业务量的设备，例如智能电表等设计的一套节能机制，使得IoT设备能够尽可能长时间的处于休眠状态，从而实现极低功耗的目的。建立TWT协议后，站点无需接收Beacon帧，而是按照一个更长的周期醒来。802.11ax标准对其进行改进，引入了一些针对站点行为的规则，在满足节能的前提下实现了对信道接入的管控。
- TWT分为单播TWT和广播TWT
	- 单播是指TWT请求站点(TWT Requesting STA，简称请求站点)向TWT应答站点发送TWT请求消息，请求设定一个醒来的时间；应答站点在接收到TWT请求消息之后向请求站点发送TWT应答消息，交互成功后，请求站点与应答站点之间就建立了一个TWT协议。
	- 广播TWT提供了一种“批量管理”机制，AP可以与多个STA建立一系列周期性出现的TWT服务阶段，在服务阶段中，上述多个STA需要保持活跃状态，从而与AP进行通信。AP 可以在 Beacon 帧中携带一个或多个 广播 TWT 的信息，每个广播 TWT 是由一个广播 TWT 标识符和 AP 的 MAC 地址共同表示的。STA 在收到 Beacon 帧后，如果有加入广播 TWT 的意愿， 可以向 AP 发送广播 TWT 建立请求消息，从而加入广播 TWT。在广播 TWT 建 立时，需要指定广播 TWT 标识符来请求加入某个特定的广播 TWT。加入广播 TWT 之后，STA 可以按照 TWT 参数集所指示的服务阶段唤醒，从而与 AP 进 行通信。需要说明的是，若 STA 支持广播 TWT，但没有显式地加入某个广播 TWT ID，则默认参与广播 TWT 标识符为 0 的广播 TWT。