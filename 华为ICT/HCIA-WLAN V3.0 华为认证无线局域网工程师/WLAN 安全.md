## WLAN安全威胁与防御
### WLAN常见安全威胁
![[Pasted image 20241103154716.png]]
- 以无线射频信号作为业务数据的传输介质，这种开放的信道使攻击者很容易对无线信道中传输的业务数据进行窃听和篡改。通过配置WLAN安全，可以防止攻击，并有效保护合法用户的信息和业务
- 主要包括以下方面：
	- 边界防御安全：很容易受到各种网络威胁的影响，如未经授权的AP用户、Ad-hoc网络、拒绝服务型攻击。无线入侵监测系统WIDS(Wireless Intrusion Detection System)可以检测非法的用户或AP；无线干扰防御系统WIPS(Wireless Intrusion Prevention System)可以保护企业网络和用户不被无线网络上未经授权的设备访问
	- 用户接入安全：用户接入无线网络的合法性和安全性，包括：链路认证，用户接入认证。
	- 业务安全：保证用户的业务数据在传输过程中的安全性，避免合法用户数据在传输过程中被非法截获
### WLAN安全防御
![[Pasted image 20241103155329.png]]
## WLAN接入安全
### WLAN接入过程
![[Pasted image 20241103155426.png]]
### 链路认证：开放系统认证
![[Pasted image 20241103155513.png]]
### 链路认证：共享密钥认证
![[Pasted image 20241103155532.png]]
- STA向AP发送认证请求(Authentication Request)
- AP随即生成一个挑战短语发给STA
- STA使用预先设置好的秘钥加密“挑战短语”并发给AP
- AP接受到经过加密的挑战短语，用预先设置好的密钥解密该消息，然后将解密后的“挑战短语”与之前发送给STA的进行比较。如果相同，认证成功；否则认证失败
### 用户接入安全概述
![[Pasted image 20241103155808.png]]
### 接入认证安全策略：WEP
![[Pasted image 20241103160024.png]]
- WEP的核心是采用RC4算法，加密密钥长度有64位、128位和152位，其中有24bit的IV(初始向量)是由系统产生的，所以WLAN服务端和WLAN客户端上配置的密钥长度是40位、104位或128位。WEP加密采用静态的秘钥，接入同一SSID下的所有STA使用相同的密钥访问无线网络
- WEP安全策略包括了链路认证机制和数据加密机制
	- 如果选择开放系统认证方式，链路认证过程不需要WEP加密。用户上线后，可以通过配置选择是否对业务数据进行WEP加密
	- 如果选择共享密钥认证方式，链路认证过程中完成了密钥协商。用户上线后，通过协商出来的密钥对业务数据进行WEP加密
### 接入认证安全策略：WPA/WPA2
![[Pasted image 20241103162919.png]]
- 由于WEP共享密钥认证采用的是基于RC4对称流的加密算法，需要预先配置相同的静态密钥，无论从加密机制还是从加密算法本身，都很容易受到安全威胁
- 为了解决这个问题，WiFi联盟推出了针对WEP改良的WPA。WPA的核心加密算法还是采用RC4，在WEP基础上提出了临时秘钥完整性协议TKIP(Temporal Key Integrity Protocol)加密算法，采用了x的身份验证框架，支持EAP-PEAP、EAP-TLS等认证方式
- 随后i安全标准组织又推出WPA2，区别于WPA，WPA2采用安全性更高的区块密码锁链-信息真实性检查码协议CCMP(Counter Mode with CBC-MAC Protocol)加密算法
- 为了实现更好的兼容性，在目前的实现中，WPA和WPA2都可以使用x的接入认证、TKIP或CCMP的加密算法，他们之间的不同主要表现在协议报文格式上，在安全性上没有差别
- 综上，WPA/WPA2安全策略涉及了链路认证阶段、接入认证阶段，密钥协商和数据加密阶段
### PSK与PPSK认证介绍
![[Pasted image 20241103163717.png]]
- PSK(Pre-Shared Key，预共享密钥) 要求在STA侧预先配置Key，AP通过4次握手Key协商协议来验证STA侧Key的合法性。对于安全要求较低的网络，可使用WPA-PSK的预共享密钥模式
- PSK认证需要实现在无线客户端和设备端配置相同的预共享密钥，可以通过是否能够对协商的消息成功解密，来确定本端配置的预共享密钥是否和对端配置的预共享密钥相同，从而完成服务端和客户端的互相认证
- 当在A/A2中使用该认证时，只需在每个WLAN节点预先输入一个预共享密钥，虽然部署简单，但对于连接到相同SSID的所有客户端，预共享密钥相同，可能会导致未授权的用户共享密钥
- 如图所示，WPA/WPA2-PSK认证，对于连接到指定SSID的所有客户端，密钥将保持相同，从而存在安全风险。使用WPA/WPA2-PPSK认证，连接到同一SSID的每个用户都可以有不同的密钥，根据不同的用户可以下发不同的授权，并且如果一个用户拥有多个终端设备，这些终端设备也可以通过同一个PPSK账号连接到网络~
- WPA/WPA2-PPSK认证具有以下特点
	- 连接到同一SSID的每个用户都可以有不同的密钥。
	- 配置和部署简单。
	- 如果一个用户拥有多个终端设备，这些终端设备也可以通过同一个PPSK用户连接到网络。
	- PPSK用户绑定用户组或者授权VLAN，根据不同的PPSK用户可以下发不同的授权。

## WLAN数据安全
### WLAN安全加密
![[Pasted image 20241103164939.png]]
- 开放性介质 不采取适当保护的话，风险大幅增加 
- 通信安全三种目的：当数据通过网络，数据保护协议必须能够协助网管人员达成以下目的
	- 机密性 防范数据不受未经授权的第三者拦截
	- 完整性 确定数据没有遭到篡改
	- 认证 所有安全策略的基础 因为数据的可信度，部分取决于数据来源的可靠性。使用者必须确认数据的来源的正确性。是必须利用认证来保护数据 授权与访问控制两者均基于真实性之上，在允许访问任何数据之前，是统必须确认使用者的身份(真实性)，以及是否允许该使用者访问数据
- WLAN加密完全的目的要保证数据的机密性和完整性
### WLAN安全策略对比
![[Pasted image 20241103165250.png]]
## WLAN网络准入控制
### NAC概述
![[Pasted image 20241103193322.png]]
### AAA
![[Pasted image 20241103193339.png]]
### RADIUS概述
![[Pasted image 20241103193409.png]]
### 802.1X 认证
![[Pasted image 20241103193431.png]]
### MAC认证
![[Pasted image 20241103193445.png]]
### Portal认证
![[Pasted image 20241103193458.png]]
- 定义
	- Portal认证通常也被称为Web认证，一般将Portal认证网站称为门户网站。用户上网时，必须在门户网站进行认证，如果未认证成功，仅可以访问特定的网络资源，认证成功后，才可以访问其他网络资源
- 优点
	- 一般情况下，客户端不需要安装额外的软件，直接在Web页面上认证，简单方便。
	- 便于运营，可以在Protal页面上进行业务拓展，如广告推送、企业宣传等。
	- 技术成熟，被广泛应用于运营商、连锁快餐、酒店、学校等网络
	- 部署位置灵活，可以在接入层或关键数据的入口访问控制
	- 用户管理灵活，可基于用户名与VLAN/IP地址/MAC地址的组合对用户进行认证
### MAC优先Protal认证
![[Pasted image 20241103193535.png]]
- 该功能需要配置MAC+Protal的混合认真，同时在认证服务器上开启MAC优先的Protal的认证功能并配置MAC地址有效时间
- 如果客户端的MAC地址还保存在RADIUS服务器，则RADIUS服务器校验用户名和密码(用户名和密码均为MAC地址)后，直接进行授权，用户授权后即可直接访问网络，不需要再次输入用户名密码进行认证
- 如果客户端的MAC地址在RADIUS服务器已经过期，则服务器会删除保存的客户端MAC地址。MAC地址认证失败之后，接入设备会向客户端用户推送Protal认证页面。客户端用户输入账号和密码完成身份认证。
### 三种认证方法比较
![[Pasted image 20241103193558.png]]

## WLAN安全配置
### 配置开放认证
![[Pasted image 20241104100347.png]]
- Security open
	- 指定WEP认证方式为开放模式

### 配置WEP安全策略
![[Pasted image 20241104101427.png]]
- Security wep 指定wep认证方式为共享密钥模式
- Security wep share-key 指定wep认证方式为共享密钥模式时
	- 配置该参数 表示使用密钥对无线终端认证，并对业务报文加密。
	- 不配置表示仅使用共享密钥对业务报文加密
- 无论该参数是否配置，无线终端上的设置都相同，需要输入共享密钥
- Security wep dynamic 指定WEP认证方式为动态WEP方式
- wep key命令
	- key-id 密钥索引
	- wep-40 使用wep-40方式认证
	- pass-phrase 密钥短语
	- hex 16进制
	- key-value 以密文形式显示用户口令
### 配置WPA/WPA2-PSK认证
![[Pasted image 20241104101907.png]]
- wpa 使用wpa WiFi网络安全存取版本1 认证方式
- wpa2 使用wpa2 认证方式
- psk 采用psk
- pass-pharse 密钥短语
- hex 16进制数
- key-value 用户口令
- aes 使用aes 对称加密算法 方式加密数据
- tkip 临时秘钥完整性协议
- aes-tkip 混合加密 支持aes或tkip 通过后即可使用支持的算法加密数据

### 配置WPA/WPA2-PPSK认证
![[Pasted image 20241104103158.png]]
- pass-phrase 密钥短语
- hex 16进制数
- key-value 以密文形式显示用户口令
- user-name user-name 指定PPSK用户的用户名‘
	- 创建PPSK用户时如果不指定user-name 则自动生成用户名ppsk_auto_user_xxx，xxx表示数字编号。如果指定user-name，则必须保证用户名的唯一性
- user-group user-group 指定PPSK用户绑定的用户组
- vlan vlan-id 指定PPSK用户绑定的授权VLAN
- expire-date expire-date[]:指定PPSK用户的过期时间，超过规定日期的用户无法接入，如果不指定该参数则有效期到2099年12月31日
- max-device max-device number 指定允许接入的最大用户
- mac-address 指定PPSK用户绑定的MAC地址
- ssid 指定PPSK用户接入的SSID
### 案例：PSK和PPSK
![[Pasted image 20241104103914.png]]
![[Pasted image 20241104103905.png]]
#### 创建安全模板
![[Pasted image 20241104103941.png]]
#### 绑定模板
![[Pasted image 20241104103951.png]]
#### 查看AP信号信息
![[Pasted image 20241104104035.png]]
