# Chapter1 计算机网络基础

## 计算机网络的概念和体系结构

计算机网络是指将地理位置不同的，具有独立功能的多台计算机及其外部设备通过通信链路连接起来，实现资源共享和信息传递的计算机系统



因特网被称为网络的网络。



### 计算机网络的应用形态

资源搜索、在线支付、网络购物、点餐上门、拼车打车、音视频点播、网上办公、计步导航



### 计算机网络的分类

#### 按照网络共享服务方式划分

C/S 、 P2P 、 B/S 、 混合形态

#### 按照网络节点分布范围划分

局域网(<10km) 、 城域网(10-100km) 、 广域网、(>1000km)

#### 分层好处：

复杂系统分层简化，方便对系统储层分析，整体解决

研发人员只需关注本身层即可，易于模块化实现和开发

按层指定标准，标准简单明确，修订容易

分层后更清晰，拓展性增强

更易修改和维护



![image-20240924125337546](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240924125337546.png)

ISO提出的OSI参考模型。

![image-20240924125434503](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240924125434503.png)

### 数据发送

![image-20240924125536283](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240924125536283.png)

## 计算机网络的核心协议

### 网络协议主要有哪些

> 1.网络节点身份标识协议：用来标识网络节点身份，如MAC，IPv4，IPv6，RFID等
>
> 2.网络数据传输协议：保证网络节点数据正确到达目标节点，如HDLC、TCP、UDP等
>
> 3.网络链路竞争协议：保证每个网络节点均有机会使用网络链路传输信息，如CSMA、Token等
>
> 4.网络资源共享协议：保证不同组织和个人的信息可以共享、公用，如HTTP、FTP、SMTP等

### 网络节点身份标识协议

局域网使用网络硬件地址(MAC)来表示网络当中的唯一设备，多个局域网互联而成的广域网，使用的是逻辑地址标识网络。

### MAC地址

唯一的网络标识  媒体存取控制地址  局域网地址  网卡地址   确定网络节点的身份和位置  写在硬件内部   48位 6字节

用：-隔开   前三字节是网络硬件制造商的编号  后三位由网络制造商自行分配代表某个产品  基于该特点，局域网使用其



如何查询

控制面板 网络共享中心 本地连接 详细地址 物理地址



### IP地址

为了屏蔽每个网络之间的差异性，做出互联和互通。全网唯一的地址。  就像通信住址。32位 4字节 点分十进制 a.b.c.d 0-255 

#### 分类

A类 最高位为0 后接 1-8位的网络标识符和 9-31为主机标识符  地区网 2

B类 最高位为10 后接2-16位的网络标识符 17-31为主机标识符  单位或公司 65534

C类 最高位为110 后接3-24位的网络标识符 25-31为主机标识符  较小的单位或公司 254

D类 最高位为1110 后接多播组号

E类 最高位为11110 留待后用



主要使用的是ABC三类

32位全1为广播地址 为0表示网络本身 高八位为01111111 是回送地址 用于网络软件测试以及本地进程间通信。

![image-20240924203138628](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240924203138628.png)

### IP地址和MAC之间的区别

#### IP

1. IP基于拓扑设计，在一台网络设备或计算机上，修改很简单
2. 长度32位
3. IP应用于OSI/RM第三层 网络层

#### MAC

1. 是网卡生产厂商烧录好的，一般不能改动
2. 长度48位
3. 应用在OSI第二层 数据链路层

### 数据传输协议

#### HDLC协议

早期链路层控制协议是面向字符的，典型为IBM公司的二进制同步通信协议(BSC)，于1974年推出SDLC(面向比特的链路控制协议)，ISO后来修改为高级数据链路控制(HDLC) 不依赖任何字符集和编码集



两种类型传输模式

**同步**(固定时间)和**异步**(以字节为单位，需要使用额外的起始位和截止位)

互联网使用同步

分为六个字段，分别是

1. 首字段(标志字段F)：01111110

   实际中可能会和传输信息当中的0和1相同的字段，所以引入了所谓"零比特插入"技术来解决这个问题

2. 地址字段(A):

   指定接受者地址，默认一字节(最多寻址254台主机)，也可拓展多字节。全1为广播，全0无效，以太网中，该字段长度为6字节(MAC地址)

3. 控制字段(C):

   8-16位

   用于指示帧的类型，以便对链路进行监控，长度默认一字节，可扩展到两字节。以太网中长度为2字节。

   控制字段C最高可以有两比特用来存储类型，分别是信息帧0,监督帧10 无编号帧11三种类型

   当为监督帧的时候，分为以下四种情况

   1. 10(监督帧)00 -> 接受就绪RR
   2. 1001 -> 拒绝所有REJ
   3. 1010 -> 接受未就绪RNR
   4. 1011 -> 选择拒绝SREJ

4. 信息字段(I):

   承载来自网络层的数据(如IP数据包)。长度由FCS或通讯节点的缓存容量来决定，使用较多的上限是1000-2000bit，下限是0(S帧)，以太网中I的长度为46-1500B之间。

5. 帧校验字段(FCS):

   对两个标志字段之间的内容进行错误检测，默认为两字节，以太网中扩展至四字节，使用CRC循环冗余校验技术。检查范围是A-I。CRC用于差错控制编码。

6. 标志字段(F)



#### 零bit插入技术

是指发送端监视除标志字段F以外的所有字段，当发现有连续的5个1出现的时候，在后面添加一个0

而接收端只需要发现除了标志字段之外的所有字段，有连续的五个1出现的时候，删除末尾的0即可还原



### TCP-IP协议

#### TCP

面向连接、可靠、基于字节流  多网络应用  对报文长度有限定， 内容<64K  解决通信问题 报头长度固定20B

![image-20240925104802009](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925104802009.png)

1. 源端口和目标端口：各占16位，分别表示连接两段的应用进程。

2. 序号字段：32b，是对每个字节的编号
3. 确认序号：采用负载应答方式，指出下一个期望接受的字节序号，也就是告诉对方，这个序号之前的字节都已经收到
4. 数据偏移：占4位，单位是32位，用以指明报文头部的总长度
5. 标志位字段：6b组成，包括URG、ACK、PSH、RST、SYN和FIN位，用于说明TCP段的目的与内容。
6. 窗口字段：用于控制对方所能发送的数据量，单位为字节。
7. 校验和：对TCP报文的首部和数据部分进行校验
8. 紧急指针：用于指出窗口中紧急数据的位置，优先传送
9. 任选字段：最大报文长度(MSS)的选项，只能在链接建立时使用
10. 填充字段：用于保证任选项长度为32位的整数倍



TCP建立链接的可靠性，在连接时采用三次握手，又因为该连接是全双工的，只要有一方发送完毕，就会单独关闭该方的连接。

##### 建立连接过程

客户端先发送一个连接请求，此时客户端SYN=1，seq=x(随机数)，等待服务端接受，并进入同步发送状态，服务端接收之后，返回一个SYN=1，ACK=1，序号为y，ACK序号seq=x+1，接下来客户端接受syn确认报文，发送ACK=1，ACK的序号y+1，此时连接建立。结束同步发送状态

##### 流控

主要用于解决收发双方处理能力不匹配问题

最简单的处理策略是接收方通知发送方自己的处理能力，然后发送方按照能力发送

在TCP协议中采用动态缓存分配和可变大小的滑动窗口协议来实现流量控制

TCP报文中的窗口字段就是用于双方交换接受窗口的尺寸(以B为单位)



拥塞控制

传输分组过多，超过承载能力。会丢掉一些分组，性能变差，可能会造成死锁。轻度拥塞状态是理想状态。

诞生了这个机制。



最初只有窗口



1986 Van Jacobson提出了慢启动算法，后来这个算法与拥塞避免算法、快速重传和快速恢复算法共同用于解决TCP中的拥塞控制问题。

#### IP

##### IP的编址方案

##### 分组封装格式

###### IP分组

网络层 无连接的数据报传送机制  不验证 不确认 不保证顺序 不保证可靠性 可靠性由上层协议完成



包括分组头和数据区



分组头：存放IP的具体控制信息

数据区包含了上层协议提交给IP协议传送的数据

分组长度是4字节的整数倍。

![image-20240925111417827](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925111417827.png)

版本指明: ipv4or6

头部长度：4B 

服务类型:指明IP分组的优先级，包括可靠性，吞吐量，延时等要求

总长度包括16B 包括分组头和数据区的长度

标识符占16位 唯一标识一个IP分组

标志位 1位保留 DF位用于指明IP分组是否允许分段 MF位用于表明是否有后续分段

偏移量占 13位 8byte为一个单位 指明当前报文片在原始IP分组中的位置

生存期 8bit 在网络中可以传输的距离 经过路由器 -1 为0 会抛弃 保真不会在网络中无休止传输

协议 8bit 6TCp UDP 14

校验和保证IP分组的完整性

##### 分组转发规则

###### IP路由协议

![image-20240925112459878](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925112459878.png)

最佳路径也就是最少跳跃数

方法是Dijkstra算法

![image-20240925114036011](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925114036011.png)

![image-20240925114046530](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925114046530.png)

### 网络链路争用协议

大量网络节点共享同一通信链路或信道时，解决的首要问题就是共享信道的分配。多路访问协议是解决该问题主要手段。分为有冲突协议和无冲突协议。

#### 有冲突协议

节点在发送数据前不需要与其他节点协调对信道的使用权，有数据就发送。当多节点共同发送时就会产生冲突。典型的有冲突协议包括CSMA/CD协议

> CSMA/CD协议
>
> 以太网作为IEEE802.3标准的一个应用实例，所有计算机共享一条总线，信息以广播方式发送。为了保证数据通信的方便性和可靠性。以太网简化了通信流程并使用了CSMA/CD(Collision Detection)的方式对总线进行访问控制。该协议是一种冲突检测的载波监听多路访问的方法。
>
> ![image-20240925115613110](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925115613110.png)

#### 无冲突协议

对于该协议中的局域网，按照特定仲裁策略完成发送过程，避免冲突产生。令牌协议是一个典型。当想要发送数据时，要首先截获令牌，类似接力。由于只有一个令牌，故不会产生冲突。所以典型的无冲突协议网络包括令牌总线网和令牌环网。

![image-20240925115237185](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925115237185.png)

### 网络资源共享协议

#### WWW万维网

是一种基于超文本传输协议HTTP的、全球性的、动态交互的、跨平台的分布式图形信息系统。使用了一种全新的BS模型，是对CS模型的一种改进

![image-20240925122002006](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925122002006.png)

#### Web服务的资源请求过程

![image-20240925122223610](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925122223610.png)

#### 电子邮件服务模型

在电子邮件系统中，邮件发送方和接收方作为客户端，一般通过邮件代理来进行邮件的编辑、发送和接收。

![image-20240925122847599](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925122847599.png)

![image-20240925122859838](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925122859838.png)

SMTP建立在FTP之上，用于系统之间的邮件信息传递，并提供来信通知。

POP3 是第一个连线的电子邮件协议，允许用户从服务器上接收邮件并存储到本地，同时根据客户端的额操作来同步操作服务端。

### 物联网的概念、模型、协议

#### 什么是物联网

![image-20240925123424183](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925123424183.png)

通过使用射频识别技术、传感器、红外传感器等设备，按照约定的协议，将任何物品和互联网联系起来，实现通信和信息交换。实现智能化识别等一系列属性。



#### 什么是RFID

非接触式全自动识别技术。基本原理是利用电磁信号和空间耦合电感的传输特性实现对象信息的无接触传递，从而实现对静止或易懂的物体或人员的非接触自动识别。

组成结构如下图所示

![image-20240925124025858](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925124025858.png)

三部分

电子标签

​	射频标签是由耦合元件和芯片组成 具有全球唯一的电子编码 附着在标签上就可以实现唯一编码 体积很小，厚度很薄 印制在外包装上或嵌入在物体内 例如身份证，公交卡

读写器

​	利用射频技术读取信息的设备 是标签和后台系统的接口 接受范围受很多因素的影响 读写器利用天线在周围形成电磁场，发射特定的询问信号，当电子标签感应到询问信号后，就会给出应答信号 应答信号中含有电子标签携带的数据信息 固定式读写器和手提式读写器

数据管理系统



#### RFID的识读协议

多种协议 流行的是：基于hash运算的安全认证协议 加密通过hash 湿度流程采用三次握手协议

![image-20240925124620908](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925124620908.png)

通过三次握手可以保证建立连接的可靠

## 计算机网络设备和配置管理

### 网内互联设备

#### 网卡 、 网络传输介质、中继器和集线器、交换机

网卡：网络适配器数据来源于计算机，通过传输介质传给另一台计算机。这个时候就需要有一个接口，将计算机和传输介质连接起来，网卡就是这个用处

网络传输介质： 双绞线(星形网络)、同轴电缆(总线型网络)、光纤(主干网)  

中继器和集线器：中继器是局域网互联的最简单设备，工作在物理层，用来连接不同的物理介质，在各种物理介质中传输数据包  中继器：HUB拥有多个端口的集线器 集线器的每一个端口都是一个中继器

![image-20240925161243002](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925161243002.png)

交换机：完成信息交换工程 为接入到的任意两个节点，提供独享的电信号通路，同一时刻可以进行多个端口之间的数据传输，每一个端口都可以视为独立的网段 链接的设备享有全部的带宽，无需同其他设备竞争使用

##### 分为三大类：接入层、汇聚层、核心层交换机

接入：面向用户，将用户终端连接到网络。有低成本和高端口密度特性，一般应用在办公室、小型机房和业务受理较为集中地业务部门，多媒体制作中心、网站管理中心等部门。传输速度上，接入层交换机大多提供具有10/100/1000MB自适应能力的端口

汇聚：一般用于楼宇之间的多台接入层交换机的汇聚，能够处理来自接入层设备的所有通信量，并提供到核心层的上行链路，需要更高的性能，更少的接口和更高的交换速率。

核心：用来链接多个汇聚层交换机，主要目的在于通过高速转发通信，提供优化，可靠的骨干传输结构，因此核心层交换机具有更高的可靠性，性能和吞吐量。

![image-20240925162023410](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925162023410.png)

### 网间互联设备

#### 网桥

在数据链路上实现网络互联 基于数据帧的数据存储转发设备。

具有寻址和路径选择等功能

目的地址是本网工作站的就删除，另一个网络的发送到目的网工作站 筛选-过滤功能 隔离掉不需要在网间传播的信息



具有网络管理功能：对扩展网络的状态进行监督，以便更好地调整网络拓扑逻辑结构，有些网桥还可以对转发和丢失的帧进行统计，以便进行系统维护。 对广播消息不能识别，不能过滤。容易形成广播风暴

#### 路由器

区别 交换发生在第二层 路由发生在第三层

路由和交换在传输信息过程中，需要使用不同的控制信息。



是一种用来连接互联网中各局域网、广域网的设备，根据信道情况自动选择和设定路由，以最佳路径按照前后顺序发送信号



##### 无线路由器

链接有线和无线网络的通讯设备，通过WiFi技术收发无线信号，来与个人数码电话和笔记本通讯，可在不设电缆的情况下，方便的建立一个网络。

每个无线路由器都可以设定一个业务组标识符，简称SSID，移动用户通过ssid可以搜索到该无线路由器，通过输入登录密码就可以无线上网。SSID是一个32位的数据，其值区分大小写，可以使无线局域网的物理位置标识，人员姓名或公司名称等。

更容易被窃听(相对无线网)，在IEEE802.11中采用了WEP协议来设置安全机制，进行业务流的加密和认证，容易被破解->WPA和WPA2、WPA3被提出



### 网关

转换器，既可以用与广域网，也可以用于局域网，在使用不同的通信协议，数据格式和语言，或体系结构不同的两种系统之间，网关只是一个翻译器。 因为要对收来的信息重新打包，所以网关也可以提供过滤和安全功能

主要功能：完成互联网络协议之间的转化、完成报文的存储转发和流量控制、完成应用层的互通及互联网间网络管理功能、提供虚电路接口及相应的服务。

### 网络管理

![image-20240925165042028](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925165042028.png)

包括对硬件、软件和人力的使用、综合和协调

以便实现对网络资源的监视、测试、配置、分析、评价和控制，这样就能以合理的价格满足网络的一些需求，例如实时运行性能和服务质量等。另外，出现故障能及时协调和处理，并保证网络的高效运行，简称网管。

#### 网络管理方案

##### 简单网络管理协议：

SNMP，已经成为网络管理领域中事实上的工业标准，并被广泛支持和应用，大多数系统和平台都是基于SNMP的

![image-20240925165531901](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925165531901.png)

VLAN内部的单播和广播流量不会转发到其他VLAN中，有助于防止广播风暴。划分可以采用静态或动态的机制

静态是指VLAN管理员固定了交换机端口和VLANID的对印关系，

交换机为主机自动配置端口所在的VLAN，就是动态了

​	三种方式

​	基于MAC的VLAN、IP的VLAN（三层交换机）、用户的VLAN、

![image-20240925170012816](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925170012816.png)

华为VRP体系结构

![image-20240925170129196](./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240925170129196.png)

